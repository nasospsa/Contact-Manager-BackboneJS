define([],function(){var e=Backbone.View.extend({tagName:"article",className:"contact-container",template:_.template($("#contactTemplate").html()),editTemplate:_.template($("#contactEditTemplate").html()),events:{"click button.delete":"deleteContact","click button.edit":"editContact","change select.type":"addType","click button.save":"saveEdits","click button.cancel":"cancelEdit"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},editContact:function(){this.$el.html(this.editTemplate(this.model.toJSON()));var e=$("<option/>",{html:"<em>Add new...</em>",value:"addType"});this.select=this.options.directoryView.createSelect().addClass("type").val(this.$el.find("#type").val()).append(e).insertAfter(this.$el.find(".name")),this.$el.find("input[type='hidden']").remove()},addType:function(){this.select.val()==="addType"&&(this.select.remove(),$("<input />",{"class":"type"}).insertAfter(this.$el.find(".name")).focus())},saveEdits:function(e){e.preventDefault();var t={},n=this.model.previousAttributes();$(e.target).closest("form").find(":input").not("button").each(function(){var e=$(this);t[e.attr("class")]=e.val()}),t.photo===""&&delete t.photo,this.model.set(t),this.render(),n.photo==="/img/placeholder.png"&&delete n.photo,_.each(this.options.directoryView.contacts,function(e){_.isEqual(e,n)&&this.options.directoryView.contacts.splice(_.indexOf(contacts,e),1,t)}),this.options.directoryView.$el.find("#filter").find("select").remove().end().append(this.options.directoryView.createSelect())},cancelEdit:function(){this.render()},deleteContact:function(){var e=this.model.get("type").toLowerCase();this.model.destroy(),this.remove(),_.indexOf(this.options.directoryView.getTypes(),e)===-1&&this.options.directoryView.$el.find("#filter select").children("[value='"+e+"']").remove()}});return e})